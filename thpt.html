<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ƒê·∫øm ng∆∞·ª£c k·ª≥ thi THPT Qu·ªëc Gia - Premium</title>
  <style>
    /* Reset */
    * {
      box-sizing: border-box;
    }
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f0f4f8;
      color: #222;
      transition: background-color 0.4s ease, color 0.4s ease;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      text-align: center;
    }
    /* Dark theme */
    body.dark-theme {
      background-color: #121212;
      color: #ddd;
    }

    h1 {
      font-size: 2.4rem;
      margin-bottom: 0.5rem;
    }

    #countdown {
      font-size: 2.8rem;
      font-weight: 700;
      margin: 1rem 0 2rem 0;
      letter-spacing: 0.05em;
    }

    #current-time {
      font-size: 1.2rem;
      margin-bottom: 1.5rem;
      font-weight: 500;
      color: #555;
    }

    /* Container t√πy ch·ªânh ng√†y thi */
    #set-date-container {
      margin-bottom: 2rem;
    }

    label {
      font-weight: 600;
      margin-right: 0.6rem;
      font-size: 1rem;
    }

    input[type="date"] {
      padding: 0.5rem 0.7rem;
      font-size: 1rem;
      border-radius: 5px;
      border: 1.8px solid #007bff;
      outline: none;
      transition: border-color 0.3s ease;
    }
    input[type="date"]:focus {
      border-color: #0056b3;
    }
    button#btn-set-date {
      background-color: #007bff;
      color: white;
      font-weight: 600;
      border: none;
      padding: 0.55rem 1.2rem;
      margin-left: 1rem;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }
    button#btn-set-date:hover, button#btn-set-date:focus {
      background-color: #0056b3;
      outline: none;
    }

    /* Top controls: n√∫t ƒë·ªïi theme v√† nh·∫°c */
    #top-controls {
      position: fixed;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 10px;
      align-items: center;
      z-index: 9999;
      background: rgba(0,0,0,0.25);
      padding: 6px 12px;
      border-radius: 30px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    #top-controls button {
      background: #007bff;
      border: none;
      color: white;
      font-size: 1.3rem;
      padding: 8px 12px;
      border-radius: 50%;
      cursor: pointer;
      transition: background-color 0.3s ease;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 44px;
      height: 44px;
      user-select: none;
    }

    #top-controls button:hover, #top-controls button:focus {
      background: #0056b3;
      outline: none;
    }

    #top-controls input[type="range"] {
      width: 100px;
      cursor: pointer;
      -webkit-appearance: none;
      background: transparent;
      vertical-align: middle;
    }

    #top-controls input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      background: #007bff;
      cursor: pointer;
      border-radius: 50%;
      border: none;
      margin-top: -6px;
      transition: background-color 0.3s ease;
    }

    #top-controls input[type="range"]::-webkit-slider-thumb:hover {
      background: #0056b3;
    }

    /* Firefox */
    #top-controls input[type="range"]::-moz-range-thumb {
      width: 18px;
      height: 18px;
      background: #007bff;
      cursor: pointer;
      border-radius: 50%;
      border: none;
      transition: background-color 0.3s ease;
    }

    #top-controls input[type="range"]::-moz-range-thumb:hover {
      background: #0056b3;
    }

    /* Responsive nh·ªè */
    @media (max-width: 480px) {
      body {
        padding: 0.8rem;
      }
      h1 {
        font-size: 1.8rem;
      }
      #countdown {
        font-size: 2rem;
      }
      #current-time {
        font-size: 1rem;
      }
      #set-date-container label,
      #set-date-container input[type="date"],
      #set-date-container button#btn-set-date {
        font-size: 0.9rem;
      }
      #top-controls {
        padding: 5px 8px;
        gap: 6px;
      }
      #top-controls button {
        width: 36px;
        height: 36px;
        font-size: 1.1rem;
        padding: 6px 8px;
      }
      #top-controls input[type="range"] {
        width: 70px;
      }
    }
  </style>
</head>
<body>
  <h1>ƒê·∫øm ng∆∞·ª£c k·ª≥ thi THPT Qu·ªëc Gia</h1>

  <div id="set-date-container">
    <label for="exam-date">Ch·ªçn ng√†y thi:</label>
    <input type="date" id="exam-date" />
    <button id="btn-set-date">C·∫≠p nh·∫≠t</button>
  </div>

  <div id="countdown">-- : -- : -- : --</div>
  <div id="current-time">Gi·ªù hi·ªán t·∫°i: --:--:--</div>

  <!-- N√∫t ƒëi·ªÅu khi·ªÉn -->
  <div id="top-controls" role="region" aria-label="ƒêi·ªÅu khi·ªÉn giao di·ªán v√† nh·∫°c">
    <button id="btn-theme" title="ƒê·ªïi giao di·ªán" aria-label="ƒê·ªïi giao di·ªán">üé®</button>
    <button id="audio-playpause" title="B·∫≠t / t·∫Øt nh·∫°c" aria-label="B·∫≠t ho·∫∑c t·∫Øt nh·∫°c">üîà</button>
    <input type="range" id="audio-volume" min="0" max="1" step="0.01" value="0.4" title="√Çm l∆∞·ª£ng" aria-label="ƒêi·ªÅu ch·ªânh √¢m l∆∞·ª£ng nh·∫°c" />
  </div>

  <!-- Nh·∫°c n·ªÅn YouTube (·∫©n) -->
  <iframe
    id="youtube-audio"
    src="https://www.youtube.com/embed/8hZ7mgzplkg?autoplay=1&loop=1&playlist=8hZ7mgzplkg&controls=0&mute=1&enablejsapi=1"
    frameborder="0"
    allow="autoplay"
    allowfullscreen
    style="display:none"
  ></iframe>

  <script>
    (() => {
      const countdownEl = document.getElementById("countdown");
      const currentTimeEl = document.getElementById("current-time");
      const examDateInput = document.getElementById("exam-date");
      const btnSetDate = document.getElementById("btn-set-date");
      const btnTheme = document.getElementById("btn-theme");
      const btnAudioPlayPause = document.getElementById("audio-playpause");
      const audioVolumeSlider = document.getElementById("audio-volume");
      const iframe = document.getElementById("youtube-audio");

      // YouTube Iframe API
      let player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player("youtube-audio", {
          events: {
            onReady: onPlayerReady,
            onStateChange: onPlayerStateChange,
          },
        });
      }
      // Load YouTube Iframe API script
      const tag = document.createElement("script");
      tag.src = "https://www.youtube.com/iframe_api";
      document.head.appendChild(tag);

      function onPlayerReady(event) {
        player.setVolume(audioVolumeSlider.value * 100);
        // M·∫∑c ƒë·ªãnh t·∫Øt nh·∫°c, user t·ª± b·∫≠t
        player.pauseVideo();
      }

      function onPlayerStateChange(event) {
        // C√≥ th·ªÉ th√™m x·ª≠ l√Ω n·∫øu c·∫ßn
      }

      // Thao t√°c b·∫≠t/t·∫Øt nh·∫°c
      function playPauseMusic() {
        if (!player) return;
        const state = player.getPlayerState();
        if (state === YT.PlayerState.PLAYING) {
          player.pauseVideo();
          btnAudioPlayPause.textContent = "üîà";
        } else {
          player.playVideo();
          btnAudioPlayPause.textContent = "üîä";
        }
      }

      // Thay ƒë·ªïi √¢m l∆∞·ª£ng
      function setVolumeMusic(value) {
        if (!player) return;
        player.setVolume(value * 100);
      }

      btnAudioPlayPause.addEventListener("click", playPauseMusic);
      audioVolumeSlider.addEventListener("input", (e) => {
        setVolumeMusic(e.target.value);
      });

      // X·ª≠ l√Ω theme
      function toggleTheme() {
        document.body.classList.toggle("dark-theme");
        // L∆∞u theme v√†o localStorage
        if (document.body.classList.contains("dark-theme")) {
          localStorage.setItem("theme", "dark");
        } else {
          localStorage.setItem("theme", "light");
        }
      }

      btnTheme.addEventListener("click", toggleTheme);

      // Load theme l√∫c b·∫Øt ƒë·∫ßu
      function loadTheme() {
        const theme = localStorage.getItem("theme");
        if (theme === "dark") {
          document.body.classList.add("dark-theme");
        }
      }
      loadTheme();

      // X·ª≠ l√Ω ng√†y thi
      function getDefaultExamDate() {
        const now = new Date();
        return new Date(now.getFullYear(), 5, 7); // 07/06 nƒÉm hi·ªán t·∫°i (th√°ng 5 v√¨ th√°ng b·∫Øt ƒë·∫ßu t·ª´ 0)
      }

      // L∆∞u ng√†y thi trong localStorage
      function saveExamDate(dateStr) {
        localStorage.setItem("examDate", dateStr);
      }

      // L·∫•y ng√†y thi t·ª´ localStorage ho·∫∑c m·∫∑c ƒë·ªãnh
      function loadExamDate() {
        const saved = localStorage.getItem("examDate");
        if (saved) return new Date(saved);
        return getDefaultExamDate();
      }

      // C·∫≠p nh·∫≠t input ng√†y thi theo ng√†y l∆∞u
      function updateExamDateInput(date) {
        const yyyy = date.getFullYear();
        const mm = (date.getMonth() + 1).toString().padStart(2, "0");
        const dd = date.getDate().toString().padStart(2, "0");
        examDateInput.value = `${yyyy}-${mm}-${dd}`;
      }

      let examDate = loadExamDate();
      updateExamDateInput(examDate);

      btnSetDate.addEventListener("click", () => {
        const val = examDateInput.value;
        if (!val) {
          alert("Vui l√≤ng ch·ªçn ng√†y thi h·ª£p l·ªá.");
          return;
        }
        const selectedDate = new Date(val);
        if (isNaN(selectedDate)) {
          alert("Ng√†y thi kh√¥ng h·ª£p l·ªá.");
          return;
        }
        examDate = selectedDate;
        saveExamDate(val);
        alert(`Ng√†y thi ƒë∆∞·ª£c ƒë·∫∑t l√† ${val}`);
      });

      // H√†m ƒë·∫øm ng∆∞·ª£c
      function updateCountdown() {
        const now = new Date();

        // Hi·ªÉn th·ªã gi·ªù hi·ªán t·∫°i theo m√∫i gi·ªù VN
        const vnTime = new Date(
          now.toLocaleString("en-US", { timeZone: "Asia/Ho_Chi_Minh" })
        );
        currentTimeEl.textContent =
          "Gi·ªù hi·ªán t·∫°i: " +
          vnTime.toLocaleTimeString("vi-VN", { hour12: false });

        // Kho·∫£ng c√°ch ƒë·∫øn ng√†y thi (gi·ªù 0:00:00 ng√†y thi)
        const examDateStart = new Date(
          examDate.getFullYear(),
          examDate.getMonth(),
          examDate.getDate()
        );

        const distance = examDateStart - vnTime;

        if (distance <= 0) {
          countdownEl.textContent = "K·ª≥ thi ƒë√£ b·∫Øt ƒë·∫ßu ho·∫∑c ƒë√£ k·∫øt th√∫c!";
          return;
        }

        // T√≠nh ng√†y gi·ªù ph√∫t gi√¢y
        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor(
          (distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
        );
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        countdownEl.textContent = `${days
          .toString()
          .padStart(2, "0")} : ${hours
          .toString()
          .padStart(2, "0")} : ${minutes
          .toString()
          .padStart(2, "0")} : ${seconds.toString().padStart(2, "0")}`;
      }

      updateCountdown();
      setInterval(updateCountdown, 1000);
    })();
  </script>
</body>
</html>
